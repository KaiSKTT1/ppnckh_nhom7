# ğŸ“˜ Äá» CÆ°Æ¡ng NghiÃªn Cá»©u: PhÃ¢n Äoáº¡n Polyp Trong áº¢nh Ná»™i Soi Äáº¡i TrÃ ng Sá»­ Dá»¥ng U-Net Káº¿t Há»£p CBAM

---

## ğŸ“Œ ChÆ°Æ¡ng 1: Tá»”NG QUAN Äá»€ CÆ¯Æ NG

### 1.1 Giá»›i thiá»‡u vá» chá»§ Ä‘á» nghiÃªn cá»©u
PhÃ¢n Ä‘oáº¡n hÃ¬nh áº£nh y khoa lÃ  má»™t lÄ©nh vá»±c quan trá»ng trong cháº©n Ä‘oÃ¡n y táº¿, Ä‘áº·c biá»‡t lÃ  phÃ¢n Ä‘oáº¡n polyp tá»« hÃ¬nh áº£nh ná»™i soi Ä‘áº¡i trÃ ng. Polyp lÃ  nhá»¯ng tá»•n thÆ°Æ¡ng cÃ³ thá»ƒ phÃ¡t triá»ƒn thÃ nh ung thÆ°, vÃ  viá»‡c phÃ¡t hiá»‡n chÃ­nh xÃ¡c chÃºng tá»« hÃ¬nh áº£nh ná»™i soi Ä‘Ã³ng vai trÃ² quan trá»ng trong:
- Cháº©n Ä‘oÃ¡n sá»›m
- Cáº£i thiá»‡n káº¿t quáº£ Ä‘iá»u trá»‹
- Giáº£m thá»i gian vÃ  chi phÃ­ ná»™i soi
- Há»— trá»£ giÃ¡o dá»¥c y khoa vÃ  nghiÃªn cá»©u

Tuy nhiÃªn, polyp ráº¥t Ä‘a dáº¡ng vá» **hÃ¬nh dáº¡ng, kÃ­ch thÆ°á»›c vÃ  mÃ u sáº¯c**, vÃ  thÆ°á»ng tÆ°Æ¡ng Ä‘á»“ng vá»›i mÃ´ xung quanh, gÃ¢y khÃ³ khÄƒn trong phÃ¢n Ä‘oáº¡n.

NghiÃªn cá»©u nÃ y Ä‘á» xuáº¥t má»™t phiÃªn báº£n cáº£i tiáº¿n cá»§a **U-Net**, tÃ­ch há»£p **Convolutional Block Attention Module (CBAM)** Ä‘á»ƒ:
- TÄƒng kháº£ nÄƒng trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng
- Táº­p trung vÃ o vÃ¹ng quan trá»ng
- Loáº¡i bá» nhiá»…u khÃ´ng cáº§n thiáº¿t
- Cáº£i thiá»‡n phÃ¢n Ä‘oáº¡n polyp nhá» hoáº·c phá»©c táº¡p

---

### 1.2 Má»¥c tiÃªu nghiÃªn cá»©u
**Má»¥c tiÃªu chung:**  
PhÃ¡t triá»ƒn mÃ´ hÃ¬nh U-Net cáº£i tiáº¿n tÃ­ch há»£p CBAM Ä‘á»ƒ nÃ¢ng cao hiá»‡u suáº¥t phÃ¢n Ä‘oáº¡n polyp.

**Má»¥c tiÃªu cá»¥ thá»ƒ:**
1. TÄƒng cÆ°á»ng trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng cá»¥c bá»™ qua CBAM  
2. ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh trÃªn táº­p dá»¯ liá»‡u Kvasir-SEG vÃ  CVC-ClinicDB  
3. So sÃ¡nh hiá»‡u suáº¥t vá»›i U-Net tiÃªu chuáº©n vÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p hiá»‡n Ä‘áº¡i khÃ¡c

---

### 1.3 CÃ¢u há»i nghiÃªn cá»©u
- TÃ­ch há»£p CBAM vÃ o U-Net áº£nh hÆ°á»Ÿng tháº¿ nÃ o Ä‘áº¿n Ä‘á»™ chÃ­nh xÃ¡c phÃ¢n Ä‘oáº¡n?
- MÃ´ hÃ¬nh cÃ³ xá»­ lÃ½ tá»‘t cÃ¡c polyp Ä‘a dáº¡ng khÃ´ng?
- CBAM giÃºp táº­p trung vÃ o Ä‘áº·c trÆ°ng quan trá»ng ra sao?

---

### 1.4 Giáº£ thuyáº¿t nghiÃªn cá»©u
- **H1**: U-Net + CBAM Ä‘áº¡t Ä‘á»™ chÃ­nh xÃ¡c cao hÆ¡n U-Net chuáº©n  
- **H2**: MÃ´ hÃ¬nh vÆ°á»£t trá»™i vá» Dice Score vÃ  mIOU trÃªn cÃ¡c dataset chuáº©n

---

### 1.5 Pháº¡m vi nghiÃªn cá»©u
- **Ná»™i dung:** PhÃ¢n Ä‘oáº¡n polyp 2D tá»« áº£nh ná»™i soi  
- **Dá»¯ liá»‡u:** Kvasir-SEG (1000 áº£nh), CVC-ClinicDB (612 áº£nh)  
- **á»¨ng dá»¥ng:** Há»— trá»£ cháº©n Ä‘oÃ¡n vÃ  tiá»m nÄƒng má»Ÿ rá»™ng cho cÃ¡c nhiá»‡m vá»¥ y táº¿ khÃ¡c

---

### 1.6 Ã nghÄ©a cá»§a nghiÃªn cá»©u
- **Khoa há»c:** LÃ m rÃµ vai trÃ² cá»§a attention mechanism trong phÃ¢n Ä‘oáº¡n áº£nh y khoa  
- **Thá»±c tiá»…n:** Giáº£i phÃ¡p tiáº¿t kiá»‡m tÃ i nguyÃªn, phÃ¹ há»£p há»‡ thá»‘ng há»— trá»£ cháº©n Ä‘oÃ¡n

---

## ğŸ§  ChÆ°Æ¡ng 2: CÆ  Sá» LÃ THUYáº¾T

### 2.1 KhÃ¡i niá»‡m cÆ¡ báº£n
- **PhÃ¢n Ä‘oáº¡n hÃ¬nh áº£nh:** TÃ¡ch áº£nh thÃ nh vÃ¹ng cÃ³ Ã½ nghÄ©a (Ä‘á»‘i tÆ°á»£ng cá»¥ thá»ƒ)  
- **U-Net:** Máº¡ng CNN encoder-decoder, cÃ³ skip connections giÃºp phá»¥c há»“i chi tiáº¿t khÃ´ng gian

---

### 2.2 MÃ´-Ä‘un CBAM (Convolutional Block Attention Module)
- **Channel Attention:** Táº­p trung vÃ o "cÃ¡i gÃ¬" quan trá»ng  
- **Spatial Attention:** Táº­p trung vÃ o "á»Ÿ Ä‘Ã¢u" quan trá»ng  
- CBAM = Channel + Spatial, giÃºp lÃ m ná»•i báº­t Ä‘áº·c trÆ°ng quan trá»ng cáº£ vá» khÃ´ng gian vÃ  chiá»u kÃªnh

---

### 2.3 ThÃ¡ch thá»©c trong phÃ¢n Ä‘oáº¡n polyp
- Polyp Ä‘a dáº¡ng vá» hÃ¬nh dáº¡ng, kÃ­ch thÆ°á»›c, mÃ u sáº¯c  
- Ráº¥t giá»‘ng mÃ´ xung quanh â†’ khÃ³ phÃ¢n ranh giá»›i  
â†’ Cáº§n mÃ´ hÃ¬nh cÃ³ kháº£ nÄƒng trÃ­ch xuáº¥t vÃ  táº­p trung vÃ o chi tiáº¿t chÃ­nh xÃ¡c

---

### 2.4 CÃ¡c nghiÃªn cá»©u liÃªn quan
- **U-Net (2015):** Kiáº¿n trÃºc ná»n táº£ng phÃ¢n Ä‘oáº¡n  
- **CBAM (2018):** MÃ´-Ä‘un attention nháº¹, hiá»‡u quáº£  
- **Residual Blocks:** Kháº¯c phá»¥c vanishing gradient  
- **Self-Attention:** Hiá»ƒu toÃ n cá»¥c tá»‘t nhÆ°ng náº·ng tÃ­nh toÃ¡n

---

## ğŸ§ª ChÆ°Æ¡ng 3: Váº¬T LIá»†U VÃ€ PHÆ¯Æ NG PHÃP

### 3.1 Váº­t liá»‡u

- **Táº­p dá»¯ liá»‡u:**
  - Kvasir-SEG: 1000 áº£nh, Ä‘á»™ phÃ¢n giáº£i 332Ã—487 â†’ 1920Ã—1072
  - CVC-ClinicDB: 612 áº£nh, Ä‘á»™ phÃ¢n giáº£i 384Ã—288

- **Thiáº¿t bá»‹:** GPU NVIDIA Tesla P100  
- **Pháº§n má»m:** Python, TensorFlow, Albumentations (tÄƒng cÆ°á»ng dá»¯ liá»‡u)

---

### 3.2 PhÆ°Æ¡ng phÃ¡p

#### Thiáº¿t káº¿ nghiÃªn cá»©u
Thá»±c nghiá»‡m vá»›i mÃ´ hÃ¬nh **U-Net Focus + CBAM**, Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t trÃªn 2 dataset

#### Quy trÃ¬nh:
1. **Chuáº©n bá»‹ dá»¯ liá»‡u:**
   - Chia: 80% train / 10% val / 10% test
   - Augmentation: Láº­t, xoay, thay Ä‘á»•i mÃ u (Color Jitter)

2. **MÃ´ hÃ¬nh Ä‘á» xuáº¥t:**
   - **Encoder:** CBAM sau má»—i block trÆ°á»›c downsampling  
   - **Bottleneck:** Residual Blocks  
   - **Decoder:** CBAM sau upsampling + skip connection  
   - **Output:** Conv 1Ã—1 â†’ máº·t náº¡ nhá»‹ phÃ¢n  

3. **Huáº¥n luyá»‡n:**
   - Input size: 352Ã—352Ã—3  
   - Learning rate: 1e-4  
   - Optimizer: AdamW  
   - Loss: Dice Loss  
   - Epochs: 500  
   - Batch size: 4  

4. **ÄÃ¡nh giÃ¡:**
   - **Chá»‰ sá»‘:** Dice Score (DSC), Mean IOU (mIOU)

---

## ğŸ“Š ChÆ°Æ¡ng 4: THá»°C NGHIá»†M & Káº¾T QUáº¢

### 4.1 Thiáº¿t láº­p thá»±c nghiá»‡m
- GPU: NVIDIA Tesla P100  
- Dataset chia: 80% train, 10% val, 10% test  
- ÄÃ¡nh giÃ¡ trÃªn test set cá»§a Kvasir-SEG vÃ  CVC-ClinicDB

---

### 4.2 Káº¿t quáº£ Ablation Study

| MÃ´ hÃ¬nh                        | CVC-ClinicDB (DSC / mIOU) | Kvasir-SEG (DSC / mIOU) |
|-------------------------------|----------------------------|--------------------------|
| U-Net Focus + CBAM Encoder    | 0.911 / 0.836              | 0.862 / 0.762            |
| U-Net Focus + CBAM Decoder    | 0.919 / 0.852              | 0.883 / 0.801            |
| U-Net Focus + CBAM Enc/Dec    | **0.935 / 0.877**          | **0.891 / 0.803**        |

â¡ï¸ CBAM á»Ÿ cáº£ encoder vÃ  decoder Ä‘áº¡t káº¿t quáº£ tá»‘t nháº¥t

---

### 4.3 So sÃ¡nh vá»›i cÃ¡c mÃ´ hÃ¬nh hiá»‡n Ä‘áº¡i

| MÃ´ hÃ¬nh              | NÄƒm  | CVC-ClinicDB (DSC / mIOU) | Kvasir-SEG (DSC / mIOU) |
|----------------------|------|----------------------------|--------------------------|
| U-Net                | 2015 | 0.710 / 0.627              | 0.818 / 0.746            |
| ResUnet++            | 2019 | 0.763 / 0.701              | 0.813 / 0.793            |
| HRNetV2              | 2019 | 0.778 / 0.636              | 0.853 / 0.744            |
| DCRNet               | 2022 | 0.856 / 0.788              | 0.886 / 0.825            |
| MSRF-Net             | 2022 | 0.906 / 0.828              | 0.851 / 0.740            |
| **U-Net + CBAM**     | 2024 | **0.935 / 0.877**          | **0.891 / 0.803**        |

---

### 4.4 PhÃ¢n tÃ­ch & Tháº£o luáº­n
- **CBAM hiá»‡u quáº£:** Grad-CAM cho tháº¥y mÃ´ hÃ¬nh táº­p trung rÃµ hÆ¡n vÃ o ranh giá»›i polyp  
- **Æ¯u Ä‘iá»ƒm:** Nháº¡y hÆ¡n vá»›i polyp nhá», tiáº¿t kiá»‡m tÃ i nguyÃªn so vá»›i Transformer  
- **Thá»±c tiá»…n:** PhÃ¹ há»£p vá»›i á»©ng dá»¥ng lÃ¢m sÃ ng

---

### 4.5 Káº¿t luáº­n & HÆ°á»›ng phÃ¡t triá»ƒn

- âœ… **Káº¿t luáº­n:** U-Net + CBAM nÃ¢ng cao rÃµ rá»‡t Ä‘á»™ chÃ­nh xÃ¡c phÃ¢n Ä‘oáº¡n polyp  
- ğŸ”¬ **TÆ°Æ¡ng lai:** Má»Ÿ rá»™ng sang phÃ¢n Ä‘oáº¡n khá»‘i u, thá»­ nghiá»‡m attention nÃ¢ng cao hÆ¡n

---

> ğŸ“‚ *MÃ£ nguá»“n, dá»¯ liá»‡u huáº¥n luyá»‡n vÃ  mÃ´ hÃ¬nh sáº½ Ä‘Æ°á»£c cáº­p nháº­t trong repo.*

